const cardSection=document.querySelector(".card"),cardDescription=document.querySelector(".card__description"),recommendationsSection=document.querySelector(".recommendations"),URLmain="http://localhost:3000/api/goods",hrefSrc=window.location.href.split("/").slice(0,-1).join("/"),cardRender=e=>{const t=document.createElement("h2");t.classList.add("card__name"),t.innerText=e.title;const c=document.createElement("div");c.classList.add("card__wrapper");let n=e.price,a=0;e.discount&&(a=e.discount,n=Math.round(n+n/100*a)),c.insertAdjacentHTML("afterbegin",`<div class="card__img">\n                     <img loading="lazy" src= http://localhost:3000/${e.image} alt="Картинка товара" width="540" height="303">   \n                </div>\n                <div class="card__basket-wrapper">\n                    <div class="card__prices">\n                        <span class="new-price">${e.price} ₽</span>\n                        <span class="old-price">${n} ₽</span>\n                    </div>\n                    <a href="#" class="card__credit-link">В кредит от 5600 ₽</a>\n                    <div class="card__buttons-wrapper">\n                        <button class="card__btn-basket">Добавить в корзину</button>\n                        <button class="card__btn-favourites"><img src="img/icon-favourites.svg" alt=""></button>   \n                    </div>\n                    <div class="card__info-wrapper">\n                        <div class="card__info-item">\n                            <span>Доставка</span>\n                            <span class="card__info-date">1-3 января</span>\n                        </div> \n                        <div class="card__info-item">\n                            <span>Продавец</span>\n                            <span class="card__info-seller">ShopOnline</span>\n                        </div> \n                    </div>\n                    <a href="#" class="card__bell-link"><img src="img/icon-bell.svg" alt="">Узнать о снижении цены</a>\n                </div>`),e.discount&&(c.querySelector(".card__img").classList.add("card__img-discount"),c.querySelector(".card__img").dataset.text=`${e.discount}%`);c.querySelector(".card__btn-basket").addEventListener("click",(t=>{let c=JSON.parse(localStorage.getItem("basket"))||[];const a=e.title,s=e.price,i=n,r=e.image;let d=1;const o=[...c];c.length&&c!==[]&&c.map(((e,t)=>{e.titleProduct==a&&(d=e.countProduct,o.splice(o.findIndex((e=>"titleProduct"===e.field)),1),d++)}));const l={titleProduct:a,imageProduct:r,newpriceProduct:s,oldriceProduct:i,countProduct:d};localStorage.setItem("basket",JSON.stringify([...o,l]))}));const s=document.createElement("p");return s.classList.add("card__description-text"),s.innerText=e.description,cartFull={title:t,cardWrapper:c,cardText:s},cartFull},init=()=>{const e=JSON.parse(localStorage.getItem("downloadableProduct"));localStorage.removeItem("downloadableProduct"),fetch(URLmain).then((e=>e.json())).then((t=>t.filter((t=>t.title==e)))).then((e=>cardRender(e[0]))).then((e=>cardSection.prepend(e.title,e.cardWrapper)&cardDescription.append(e.cardText))).catch((e=>{console.log(e)}))};init();const cardsRenderRecom=e=>{if(e){const t=document.createElement("ul");return t.classList.add("sale__list"),e.forEach(((c,n)=>{const a=document.createElement("li");a.classList.add("sale__item",`sale__item_${n+1}`),a.addEventListener("click",(e=>{localStorage.setItem("downloadableProduct",JSON.stringify(c.title)),window.location.href=`${hrefSrc}/card.html`}));let s=e[n].price,i=0;e[n].discount&&(i=e[n].discount,s=Math.round(s+s/100*i),a.classList.add("sale__item-discount"),a.dataset.text=`${e[n].discount}%`),a.insertAdjacentHTML("afterbegin",`\n                <img loading="lazy" src= http://localhost:3000/${c.image} alt="Картинка скидок" class="stock__img" width="325" height="295">\n                <div class="sale__wrapper-prices">\n                    <span class="price-sale">${e[n].price} ₽</span>\n                    <span class="price-full">${s} ₽</span>\n                </div>\n                <p class="sale__description">${e[n].title}</p>`),t.appendChild(a)})),t}},initRecommendation=()=>{fetch(URLmain).then((e=>e.json())).then((e=>e.slice(0,8))).then((e=>cardsRenderRecom(e))).then((e=>recommendationsSection.append(e))).catch((e=>{console.log(e)}))};fetch(URLmain).then((e=>e.json())).then((e=>e.slice(0,8))).then((e=>cardsRenderRecom(e))).then((e=>recommendationsSection.append(e))).catch((e=>{console.log(e)}));
//# sourceMappingURL=../maps/card.js.map
