{"version":3,"file":"../js/shop.js","names":["recommendationsSection","document","querySelector","URLmain","basketWrapper","deliveryInfo","basketResultPriceNew","basketResultCount","basketResultPrice","basketResultDiscount","btnBasketDel","basketCheckboxAll","hrefSrc","window","location","href","split","slice","join","cardsRenderRecom","data","listWrapper","createElement","classList","add","forEach","item","index","li","addEventListener","e","localStorage","setItem","JSON","stringify","title","oldPrice","price","discount","Math","round","dataset","text","insertAdjacentHTML","image","appendChild","initRecommendation","fetch","then","response","json","items","cards","append","catch","err","console","log","ChangingQuantityGoods","initBasket","titleProductChange","signProduct","basketStorage","parse","getItem","map","titleProduct","countProduct","remove","innerHTML","resultCountProducts","resultPriceProducts","resultPriceProductsOld","basketDiv","newpriceProduct","oldriceProduct","basketItem","imageProduct","imgDelivery","src","querySelectorAll","preventDefault","titleTarget","target","closest","innerText","contains","basketEmpty","style","color","fontSize","checked","removeItem"],"sources":["shop.js"],"mappings":"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","sourcesContent":["\r\nconst recommendationsSection = document.querySelector('.recommendations');\r\nconst URLmain = 'http://localhost:3000/api/goods';\r\nconst basketWrapper = document.querySelector('.basket__products');\r\nconst deliveryInfo = document.querySelector('.delivery-info__img');\r\nconst basketResultPriceNew = document.querySelector('.basket__result-price-new');\r\nconst basketResultCount = document.querySelector('.basket__result-count');\r\nconst basketResultPrice = document.querySelector('.basket__result-price');\r\nconst basketResultDiscount = document.querySelector('.basket__result-discount');\r\nconst btnBasketDel = document.querySelector('.btn-basket-del');\r\nconst basketCheckboxAll = document.querySelector('.basket__checkbox-all');\r\nconst hrefSrc = window.location.href.split('/').slice(0, -1).join('/');\r\n\r\n\r\n// Функция рендера карточек для секции Рекомендуемые\r\nconst cardsRenderRecom = (data) => {\r\n    if(data) {\r\n       const listWrapper  = document.createElement('ul');\r\n       listWrapper.classList.add('sale__list');\r\n        \r\n        data.forEach((item, index) => {  \r\n          const li  = document.createElement('li');\r\n          li.classList.add('sale__item', `sale__item_${index+1}`);\r\n            // переход на страницу карточки по клику\r\n            li.addEventListener('click', (e) => {\r\n                localStorage.setItem('downloadableProduct', JSON.stringify(item.title));\r\n                window.location.href = `${hrefSrc}/card.html`;\r\n            })\r\n\r\n            let oldPrice = data[index].price;\r\n            let discount = 0;\r\n            if (data[index].discount) {\r\n                discount = data[index].discount;\r\n                oldPrice = Math.round(oldPrice + (oldPrice/100*discount));\r\n                li.classList.add('sale__item-discount');\r\n                li.dataset.text = `${data[index].discount}%`;\r\n              }  \r\n\r\n            li.insertAdjacentHTML('afterbegin',`\r\n                <img loading=\"lazy\" src= http://localhost:3000/${item.image} alt=\"Картинка скидок\" class=\"stock__img\" width=\"325\" height=\"295\">\r\n                <div class=\"sale__wrapper-prices\">\r\n                    <span class=\"price-sale\">${data[index].price} ₽</span>\r\n                    <span class=\"price-full\">${oldPrice} ₽</span>\r\n                </div>\r\n                <p class=\"sale__description\">${data[index].title}</p>`\r\n            );\r\n            listWrapper.appendChild(li);\r\n           \r\n        });\r\n        return listWrapper\r\n    }\r\n}\r\n\r\n// Загрузка блока рекомендаций при загрузке\r\nconst initRecommendation = () => {\r\n    fetch(URLmain)\r\n    .then((response) => response.json())\r\n    .then((data) => data.slice(0, 8))\r\n    .then((items) => cardsRenderRecom(items))\r\n    .then((cards) => recommendationsSection.append(cards))\r\n    .catch((err) => {\r\n        console.log(err)\r\n    })\r\n}\r\n    initRecommendation()\r\n\r\n\r\n    // Функци изменения количества товара при нажатии на кнопки\r\n    const ChangingQuantityGoods = () => {\r\n\r\n    }\r\n\r\n    // Загрузка блока корзины товаров\r\n    const initBasket = (titleProductChange, signProduct) => {\r\n        let basketStorage = JSON.parse(localStorage.getItem('basket')) || null;\r\n        if (basketStorage && basketStorage !== null) {\r\n            if (titleProductChange && signProduct) {\r\n                basketStorage.map((item) => {\r\n                    if (item.titleProduct == titleProductChange){\r\n                        if(signProduct == 'Plus') {\r\n                            item.countProduct++;\r\n                        }\r\n                        if(signProduct == 'Minus') {\r\n                            item.countProduct--;\r\n                        }       \r\n                    }\r\n                })\r\n                localStorage.setItem('basket', JSON.stringify(basketStorage));\r\n                basketWrapper.querySelector('.basket__products-items').remove();\r\n                deliveryInfo.innerHTML = '';\r\n            }\r\n\r\n            let resultCountProducts = 0;\r\n            let resultPriceProducts = 0;\r\n            let resultPriceProductsOld = 0;\r\n\r\n            const basketDiv  = document.createElement('div');\r\n            basketDiv.classList.add('basket__products-items');\r\n\r\n            basketStorage.forEach((item, index) => {\r\n                resultCountProducts += item.countProduct;\r\n                resultPriceProducts += (item.countProduct*item.newpriceProduct);\r\n                resultPriceProductsOld += (item.countProduct*item.oldriceProduct);\r\n\r\n                const basketItem  = document.createElement('div');\r\n                basketItem.classList.add('basket__products-item');\r\n                basketItem.insertAdjacentHTML('afterbegin',`\r\n                    <input type=\"checkbox\" name=\"basket\" value=\"select item\">\r\n                    <img src= http://localhost:3000/${item.imageProduct} alt=\"Картинака товара ${index}\">\r\n                    <div class=\"products-items__info\">\r\n                        <h3 class=\"product-title\">${item.titleProduct}</h3>\r\n                        <p>Цвет: черный</p>\r\n                        <p>Оперативная память: 16 ГБ</p>\r\n                    </div>\r\n                    <div class=\"products-item__count\">\r\n                        <button class=\"btn-subtract\"></button>\r\n                        <span class=\"quantity-goods\">${item.countProduct}</span>\r\n                        <button class=\"btn-increase\"></button>\r\n                    </div>\r\n                    <div class=\"products-item__price\">\r\n                        <span class=\"basket__new-price\">${item.newpriceProduct} ₽</span>\r\n                        <span class=\"basket__old-price\">${item.oldriceProduct} ₽</span>\r\n                        <a href=\"#\" class=\"basket__credit\">В кредит от <span>5600 ₽</span></a>\r\n                    </div>`\r\n                );\r\n                basketDiv.appendChild(basketItem);\r\n\r\n                const imgDelivery  = document.createElement('img');\r\n                imgDelivery.src = `http://localhost:3000/${item.imageProduct}`;\r\n                deliveryInfo.appendChild(imgDelivery);\r\n            })\r\n\r\n            basketWrapper.appendChild(basketDiv)\r\n\r\n            //функции при нажатии на кнопки прибавить или уменьшить количество товара\r\n            basketWrapper.querySelectorAll('.products-item__count').forEach(item => {\r\n                item.addEventListener('click', (e) => {\r\n                    e.preventDefault()\r\n                    const titleTarget = e.target.closest('.basket__products-item').querySelector('.product-title').innerText;\r\n                  if (e.target.classList.contains('btn-subtract') || e.target.closest('btn-subtract'))  {\r\n                    if (e.target.closest('.basket__products-item').querySelector('.quantity-goods').innerText < 2) {\r\n                        return\r\n                    }\r\n                    else{\r\n                        initBasket(titleTarget, 'Minus')\r\n                    }\r\n                  }\r\n                  if (e.target.classList.contains('btn-increase') || e.target.closest('btn-increase'))  {\r\n                    initBasket(titleTarget, 'Plus')\r\n                  }\r\n                })\r\n            })\r\n\r\n            basketResultCount.innerText = `Товары, ${resultCountProducts}  шт.`;\r\n            basketResultPriceNew.innerText = `${resultPriceProducts} ₽`;\r\n            basketResultPrice.innerText = `${resultPriceProductsOld} ₽`;\r\n            basketResultDiscount.innerText = resultPriceProductsOld - resultPriceProducts;\r\n         }\r\n         else {\r\n            const basketEmpty  = document.createElement('p');\r\n            basketEmpty.style.color = 'black';\r\n            basketEmpty.style.fontSize = \"50px\";\r\n            basketEmpty.innerText = 'Корзина пуста';\r\n            basketWrapper.append(basketEmpty);\r\n\r\n            basketResultCount.innerText = 'Товары, 0  шт.'\r\n            basketResultPrice.innerText = '0 ₽'\r\n            basketResultPriceNew.innerText = '0 ₽';\r\n            basketResultDiscount.innerText = '0 ₽';\r\n         }\r\n    }\r\n    initBasket(null, null);\r\n    \r\n    // Нажатие на кноку удалить всё из корзины\r\n    btnBasketDel.addEventListener('click', e => {\r\n        e.preventDefault()\r\n        if (basketWrapper.querySelector('.basket__products-items') && basketCheckboxAll.checked) {\r\n            localStorage.removeItem('basket');\r\n            basketWrapper.querySelector('.basket__products-items').remove();\r\n            basketCheckboxAll.checked = false;\r\n            deliveryInfo.innerHTML = '';\r\n            initBasket(null, null);\r\n        }\r\n       \r\n    })"]}